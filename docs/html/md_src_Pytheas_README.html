<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Pytheas: Project Pytheas</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Pytheas
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Project Pytheas </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/ysshah95/Pytheas"></a> <a href="https://coveralls.io/github/ysshah95/Pytheas?branch=master"></a> <a href="https://opensource.org/licenses/BSD-3-Clause"></a></p>
<h1>Overview</h1>
<p>This repository is created as a Final Project for ACME Robotics (ENPM808X: Software Development in Robotics). This project aims to implement autonomous navigation and mapping in an unknown environment using TurtleBot. At a high level, the simulated robot is placed in an environment where it does not know the structure of the world. Its job is to move through the environment and avoid obstacles, all while mapping the environment via laser scans and providing an operator a visual feed of an onboard camera. The operator, via ROS services, can adjust the speed of the robot, the distance threshold that constitutes an impending collision, and also initiate a "take picture" command to capture an image of interest. In addition, an operator can initiate a "stop motion" command as well as a "resume motion" command to the robot. The developed system is capable of:</p>
<ul>
<li>navigating unknown environments</li>
<li>robust in avoiding obstacles</li>
<li>simultaneously mapping the environment and</li>
<li>takes pictures when desired by the user</li>
<li>stop or resume its motion as per user command</li>
<li>Change its linear speed</li>
<li>change the threshold distance to detect obstacles</li>
</ul>
<p>Few applications of the projects include:</p><ul>
<li>Navigation of known environments like offices and factories.</li>
<li>Explorer bot to aid rescue efforts during natural disasters.</li>
<li>Remote Surveillance</li>
</ul>
<div class="image">
<img src="world/world_image.png"  width="720" height="400" border="5"/>
</div>
  <h1>About the Developer</h1>
<p>This repository is developed and maintained by Yash Shah, a masters student majoring in Robotics at University of Maryland - College Park. This repository is a part of the course ENPM808X - Software Development in Robotics.</p>
<h1>License</h1>
<p>This project is under the <a href="https://github.com/ysshah95/Pytheas/blob/master/LICENSE">BSD License</a></p>
<h1>Dependencies</h1>
<p>The dependencies of this repository are: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;* Ubuntu 16.04</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;* ROS Kinetic</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;* Gazebo</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;* Turtlebot_Gazebo package</div></div><!-- fragment --><p>To install ROS, follow the instructions on this <a href="http://wiki.ros.org/kinetic/Installation">link</a></p>
<p>&gt;Note: Gazebo &amp; Rviz will be already installed as part of the ROS distro, however, Turtlebot_Gazebo needs to be installed separately.</p>
<p>To install turtlebot_Gazebo, open a terminal and run the following command:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ sudo apt-get install ros-kinetic-turtlebot-gazebo ros-kinetic-turtlebot-apps ros-kinetic-turtlebot-rviz-launchers</div></div><!-- fragment --><p>This repository also depends on the following ROS packages:</p><ul>
<li>roscpp</li>
<li>geometry_msgs</li>
<li>move_base_msgs</li>
<li>sensor_msgs</li>
<li>message_generation</li>
<li>image_transport</li>
<li>OpenCV &amp; cv_bridge</li>
<li>Gmapping</li>
<li>map_server</li>
</ul>
<p>To install gmapping, In a terminal: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install ros-kinetic-slam-gmapping</div></div><!-- fragment --><p> To install Map_server, In a terminal: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install ros-kinetic-map-server</div></div><!-- fragment --><h1>Solo Iterative Process</h1>
<p>Solo Iterative process was used for developing this package. For detailed spreadsheet: - <a href="https://docs.google.com/spreadsheets/d/1GE0tzFm89GAz18CqMhIiQ6sidgq2nOKgIXCGFF8eoEM/edit?usp=sharing">SIP Link</a></p>
<p>Link to Sprint Planning Notes: <a href="https://docs.google.com/document/d/1sPE6u5NXbfY2vVXfAyPOCJBkPIRnAFAd8C1skGe4AzY/edit?usp=sharing">Sprint Notes Link</a></p>
<h2>Presentation</h2>
<p>Click here to access the presentation video : <a href="https://youtu.be/tE91jcoHyKs">Presentation Video</a></p>
<p>Click here to access the presentation : <a href="https://docs.google.com/presentation/d/1mXSTLhhAfFJkN31ndFjWUDk0uE9zszrx1MzICtebjzU/edit?usp=sharing">Presentation</a></p>
<h1>Build Steps</h1>
<p>To use this package, a catkin workspace must be setup first. Assuming catkin has been installed, run the following steps in the directory of your choice (a common one is ~/catkin_ws) </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ mkdir -p ~/catkin_ws/src</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ cd catkin_ws</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ catkin_make</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;$ source devel/setup.bash</div></div><!-- fragment --><p> Your workspace should now be setup and you should be able to use ros commands like <code>roscd</code> and <code>rosls</code>. Note that if you cannot use these commands or can't find ROS packages, try running <code>source devel/setup.bash</code> again in your catkin workspace.</p>
<p>To build the Pytheas Project ROS package in this repository, first clone the repository into the catkin <code>src</code> directory: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws/src</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ git clone https://github.com/ysshah95/Pytheas.git</div></div><!-- fragment --><p> Now simply run catkin_make to build the ROS package. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ catkin_make</div></div><!-- fragment --><h1>Running the Demo using Launch File</h1>
<p>To run the demo we need to run two launch files. First launch file loads the Gazebo environment and runs the terrapinavigator node to explore and map the environment. The seconds lauch file loads rviz (for visualization) and gmapping (for SLAM and Mapping).</p>
<p>After following the build instructions:</p>
<p>To run the demo, in a new terminal: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws/</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ source devel/setup.bash</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ roslaunch pytheas finalProject_demo.launch</div></div><!-- fragment --><p>This will load the turtlebot in the gazebo world and wait for 15 seconds. Now to run gmapping and Rviz, in a new terminal:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws/</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ source devel/setup.bash</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ roslaunch pytheas demo_rviz.launch </div></div><!-- fragment --><p>This will start the gmapping package and load rviz for visualization.</p>
<h2>Saving the map</h2>
<p>After the map is properly created in rviz, to save the map type the following comands in new terminal.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws/pytheas/results</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ rosrun map_server map_saver -f &lt;map_name&gt;</div></div><!-- fragment --><p>To view the saved map. In a new terminal</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ eog &lt;map_name&gt;.pgm</div></div><!-- fragment --><h1>Interacting with the <a class="el" href="class_turtlebot.html" title="Turtlebot class handles the camera and motion controller interactions for turtlebot. ">Turtlebot</a> using rosservice</h1>
<h2>Taking an Image with takeImageService service</h2>
<p>When the turtlebot is moving, you may see something that you wish to take a picture of in your image view window. To do so, you can issue a <code>rosservice</code> call to the turtlebot. The turtlebot will see this service and change the <code>takeImage</code> flag so that next time it sees the <code>/camera/rgb/image_raw</code> topic, it will take and save an image. To make this service call, open a new terminal, change directories to your workspace, source the directory, and call rosservice:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ source devel/setup.bash</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ rosservice call /takeImageService true</div></div><!-- fragment --><p>The images are saved in ~/.ros/ directory. Follow these commands to see the images.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;gnome-open ~/.ros/</div></div><!-- fragment --><p>&gt;Note: If it says to install gnome, follow the command written in terminal to install gnome.</p>
<p>It will pop up a folder where all the images are saved. An example of the image is shown below.</p>
<div class="image">
<img src="results/turtleBotImage_1.jpg"  width="320" height="200" border="5"/>
</div>
  <h2>Change Forward Speed with changeSpeedService service</h2>
<p>You may also want to change the speed at which the <a class="el" href="class_turtlebot.html" title="Turtlebot class handles the camera and motion controller interactions for turtlebot. ">Turtlebot</a> moves forward. To do so, you can issue another <code>rosservice</code> call to the turtlebot. The robot will see this service and change the <code>forwardSpeed</code> parameter to the value passed in to the service. To make this service call, open a new terminal, change directories to your workspace, source the directory, and call rosservice:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ source devel/setup.bash</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ rosservice call /changeSpeedService 1.0</div></div><!-- fragment --><p>The default speed is 0.25 m/s. The above command will change this to 1.0 m/s, causing the turtlebot to move faster in the positive x-direction.</p>
<h2>Change obstacle detection threshold with changeThresholdService service</h2>
<p>Another parameter that can be modified via <code>rosservice</code> is the distance threshold at which the turtlebot start rotating on its place to avoid an obstacle. To make this service call, open a new terminal, change directories to your workspace, source the directory, and call rosservice:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ source devel/setup.bash</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ rosservice call /changeThresholdService 0.5</div></div><!-- fragment --><p>The default threshold is 1 m. The above command will change this to 0.5 m, causing the turtlebot to get closer to an obstacle before its starts rotating on its place.</p>
<h2>Pause / Resume <a class="el" href="class_turtlebot.html" title="Turtlebot class handles the camera and motion controller interactions for turtlebot. ">Turtlebot</a> motion with toglePauseMotion service</h2>
<p>Using <code>rosservice</code>, we can also tell the <a class="el" href="class_turtlebot.html" title="Turtlebot class handles the camera and motion controller interactions for turtlebot. ">Turtlebot</a> to stop in place (or subsequently resume its motion). To make this service call, open a new terminal, change directories to your workspace, source the directory, and call rosservice:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ source devel/setup.bash</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ rosservice call /togglePauseMotionService true</div></div><!-- fragment --><p>Passing in <code>true</code> will cause the <a class="el" href="class_turtlebot.html" title="Turtlebot class handles the camera and motion controller interactions for turtlebot. ">Turtlebot</a> to stop in place if it is not already stopped, while passing in <code>false</code> will make the <a class="el" href="class_turtlebot.html" title="Turtlebot class handles the camera and motion controller interactions for turtlebot. ">Turtlebot</a> resume motion if it is not already moving. Note that the sensor data will continue to stream, it is only the <a class="el" href="class_turtlebot.html" title="Turtlebot class handles the camera and motion controller interactions for turtlebot. ">Turtlebot</a> that will stop.</p>
<h1>Running Rostest</h1>
<p>Unit tests and ROS tests have been written for this repository. To run these tests, open a new terminal and change directories to your catkin workspace. Then, run the tests using catkin and the test launch file:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws/src</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ catkin_make run_tests &amp;&amp; catkin_test_results</div></div><!-- fragment --><h1>Rosbag Feature</h1>
<p>The package <code>rosbag</code> is a common ROS tool that is used to record and playback ROS topic messages. The launch file for this project accepts a boolean flag called <code>record</code> that toggles rosbag recording if included (true for record, false for do not record). By default the rosbag is run (recorded) for 30 seconds. To run the package and record the published topics, run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ cd ~/catkin_ws/</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ source devel/setup.bash</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;$ roslaunch pytheas finalProject_demo.launch record:=true</div></div><!-- fragment --><p>The bag will be saved in /results directory.</p>
<h2>Playback using rosbag</h2>
<p>We can playback this recorded data to recreate a recorded scenario. Assuming a rosbag recording has taken place according to the above process, playback the rosbag file by executing:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ ~/catkin_ws/src/Pytheas/results</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;$ rosbag play pytheas.bag</div></div><!-- fragment --><h1>Doxygen Documentation</h1>
<p>The documentation for this project is created using doxygen-gui. To generate the documentation again, please execute following the commands:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install doxygen</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sudo apt-get install doxygen-gui</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;doxywizard</div></div><!-- fragment --><p>The documentation for this project can be found at the path docs/html/index.html.</p>
<p>Once the gui is open, select the workspace as the repository. Fill the details as required and set the source code folder to this repository. As a destination directory, create a new folder "Documentation" in the repository and select it. Following the further steps would create the documentation.</p>
<h2>Known Issues/Bugs</h2>
<p>The map created by current build is okay but not perfect. To make it more accurate, I think the autonomous navigation algorithm needs to be changed. I have used the walker (roomba type algorithm) algorithm, but it does go to every place of the environment. Hence, a random navigation algorithm along with walker algorithm could be more beneficial. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
